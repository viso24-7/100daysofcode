<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Country outline</title>

  <style>
    html,
    body,
    #viewGas{
      padding: 0;
      margin: 0;
      height: 100%;
      width: 100%;
    }
  </style>
  <link rel="stylesheet" href="https://js.arcgis.com/4.19/esri/themes/light/main.css" />
  <script src="https://js.arcgis.com/4.19/"></script>

  <script>
 require(["esri/Map","esri/layers/CSVLayer","esri/views/MapView","esri/Graphic"],(Map,CSVLayer,MapView,Graphic) => {
     var url ="data.csv";

     const csvLayer = new CSVLayer({
         url:url,
         copyright: "Europe gas",
         renderer:{
            type: "simple",  
            symbol: {
              type: "simple-marker",  
              size: 1,
              color: "transparent",
              outline: {  
                width: 1.2,
                color: "white"
              }
            }}
         });
 

     const map = new Map({
         basemap: "gray-vector",
         layers: [csvLayer]
     });

     const view = new MapView({
         container: "viewGas",
         center: [9,58],
         zoom:4,
         map:map
     });
 
    
     var csvLayerView;
     var path = [];
     view.whenLayerView(csvLayer).then(layerView => {
      const query = csvLayer.createQuery();
      query.where = "code='AT'"; 

      layerView.watch("updating",val => {
          if(!val){
            layerView.queryFeatures(query).then(res => {
              let obj = res.features;
              obj.map((el,ind) => {
                let lat = el.attributes.latitude;
                let long = el.attributes.longitude;
                let val = [long,lat];
                path.push(val)
              })
            })
          }
        })
     });

     console.log(path);
       //[[10.47123615, 46.87135404],[14.70028216, 48.58138215],[9.670345135, 47.39069106],[12.75971818, 48.12172713],[10.23173618, 47.37374503],[13.00889121, 47.85416421],[12.1602733, 46.92805409],[10.47374502, 47.43763609],[16.45200924, 47.4128451],[14.86750012, 46.61332704],[16.94618228, 48.61906417],[16.71389124, 47.54388208],[15.02860919, 49.018745],[16.50486334, 47.00676419],[12.73694505, 47.68270919],[10.4818002, 47.58651814],[13.01250012, 47.46979108],[13.44322718, 48.56023612],[12.18610918, 47.09458223],[11.01680015, 46.77332701],[10.39076335, 47.00256418],[14.5450002, 46.40749113],[13.71865401, 46.52660904],[16.11180019, 46.86971806],[9.566727209, 47.54045405],[13.72600024, 48.51559109],[9.598636109, 47.06383606],[16.10333615, 48.75000006],[13.10013611, 47.64291812],[11.1040271, 47.39652705],[16.54055415, 48.81235405],[16.45055414, 47.69805411],[9.955000099, 47.53971812],[9.633891232, 47.130554],[13.83360913, 48.77360903],[12.44055408, 46.69082712],[10.47123615, 46.87135404],[15.85902714, 46.72319116],[9.533573261, 47.27454504],[16.84471817, 48.3619731],[17.16638225, 48.0125002],[10.17333611, 47.27471804],[13.39500023, 48.36610018],[17.05389124, 47.70944512],[14.18416329, 48.59610916],[10.10944505, 46.85027322],[12.91395409, 47.72500009],[11.17715401, 46.96735399]]
     const polyline = {
         type: "polyline",
         paths: [[10.47123615, 46.87135404],[14.70028216, 48.58138215],[9.670345135, 47.39069106],[12.75971818, 48.12172713],[10.23173618, 47.37374503],[13.00889121, 47.85416421],[12.1602733, 46.92805409],[10.47374502, 47.43763609],[16.45200924, 47.4128451],[14.86750012, 46.61332704],[16.94618228, 48.61906417],[16.71389124, 47.54388208],[15.02860919, 49.018745],[16.50486334, 47.00676419],[12.73694505, 47.68270919],[10.4818002, 47.58651814],[13.01250012, 47.46979108],[13.44322718, 48.56023612],[12.18610918, 47.09458223],[11.01680015, 46.77332701],[10.39076335, 47.00256418],[14.5450002, 46.40749113],[13.71865401, 46.52660904],[16.11180019, 46.86971806],[9.566727209, 47.54045405],[13.72600024, 48.51559109],[9.598636109, 47.06383606],[16.10333615, 48.75000006],[13.10013611, 47.64291812],[11.1040271, 47.39652705],[16.54055415, 48.81235405],[16.45055414, 47.69805411],[9.955000099, 47.53971812],[9.633891232, 47.130554],[13.83360913, 48.77360903],[12.44055408, 46.69082712],[10.47123615, 46.87135404],[15.85902714, 46.72319116],[9.533573261, 47.27454504],[16.84471817, 48.3619731],[17.16638225, 48.0125002],[10.17333611, 47.27471804],[13.39500023, 48.36610018],[17.05389124, 47.70944512],[14.18416329, 48.59610916],[10.10944505, 46.85027322],[12.91395409, 47.72500009],[11.17715401, 46.96735399]]
      };

      const lineSymbol = {
         type: "simple-marker",
         color: [226, 119, 40],
         width: 2
     };

     const polylineGraphic = new Graphic({
            geometry: polyline,
            symbol: lineSymbol
     })

    view.graphics.add(polylineGraphic);
 });
  </script>
</head>

<body>
  <div id="viewGas"></div>
</body>
</html>